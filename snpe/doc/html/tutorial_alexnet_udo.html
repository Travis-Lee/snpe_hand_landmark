<!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  Copyright (c) 2016-2018 Qualcomm Technologies, Inc.
  All Rights Reserved.
  Confidential and Proprietary - Qualcomm Technologies, Inc.
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
-->
<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"></meta>
<meta http-equiv="X-UA-Compatible" content="IE=9"></meta>
<title>Snapdragon Neural Processing Engine SDK: UDO Tutorial With Weights</title>
<link href="tabs.css" rel="stylesheet" type="text/css"></link>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="autoEnterCurrentDate.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="is.css" rel="stylesheet" type="text/css" ></link>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Snapdragon Neural Processing Engine SDK
   <span id="projectnumber"></span></div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('tutorial_alexnet_udo.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">UDO Tutorial With Weights </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="alexnet_udo_overview"></a>
Overview</h1>
<p>This tutorial describes the steps needed to run UDO with weights and execute the Alexnet model using the package. The Convolution operation has been chosen in this tutorial to demonstrate the implementation of a UDO with weights.</p>
<p>The SNPE SDK provides the resources for this example under</p><ul>
<li>$SNPE_ROOT/examples/NativeCpp/UdoExample/Conv2D</li>
</ul>
<p>Information on UDO in general is available at <a class="el" href="udo_overview.html">UDO Overview</a>.</p>
<p>Information on running the Alexnet network without UDO is available at <a class="el" href="tutorial_alexnet.html">Alexnet Tutorial</a>.</p>
<p>Information on creating a UDO package and executing the model using the package is available at <a class="el" href="tutorial_inceptionv3_udo.html">UDO Tutorial</a>.</p>
<h1><a class="anchor" id="alexnet_udo_prerequisites"></a>
Prerequisites</h1>
<p>The following tutorial assumes that general <a class="el" href="setup.html#installation">SNPE setup</a> has been followed to support SDK environment, Caffe environment, and desired platform dependencies. For details on acquiring the Alexnet model visit <a class="el" href="tutorial_setup.html#tutorial_setup_alexnet">Tutorials Setup</a>.</p>
<h1><a class="anchor" id="alexnet_udo_introduction"></a>
Introduction</h1>
<p>Here are the steps to develop and run a UDO</p>
<p>1.) <a class="el" href="tutorial_alexnet_udo.html#alexnet_udo_package">Package Generation</a></p>
<p>2.) <a class="el" href="tutorial_alexnet_udo.html#alexnet_udo_conversion">Framework Model Conversion to a DLC</a></p>
<p>3.) <a class="el" href="tutorial_alexnet_udo.html#alexnet_udo_impl">Package Implementation</a></p>
<p>4.) <a class="el" href="tutorial_alexnet_udo.html#alexnet_udo_compilation">Package Compilation</a></p>
<p>5.) <a class="el" href="tutorial_alexnet_udo.html#alexnet_udo_execution">Model Execution</a></p>
<p>Steps 1-4 are run offline on the x86 host and are necessary for execution in step 5. Step 5 provides information on execution using the SNPE command-line executable snpe-net-run.</p>
<h1><a class="anchor" id="alexnet_udo_package"></a>
Step 1: Package Generation</h1>
<p>Generating the Conv2DPackage package requires the <b>snpe-udo-package-generator</b> tool and the provided UDO plugin: Conv2D.json / Conv2DQuant.json depending on your runtime requirement. The Conv2D.json and Conv2DQuant.json gives you skeleton code for CPU(float) and DSP(uint8) implementations respectively . The plugins is located under $SNPE_ROOT/examples/NativeCpp/UdoExample/Conv2D/config. More information about creating a UDO plugin can be found <a class="el" href="udo_operator_definition.html#udo_config_spec">here</a>.</p>
<p>Generate the Conv2DPackage UDO package using the following: </p><pre class="fragment">export SNPE_UDO_ROOT=$SNPE_ROOT/share/SnpeUdo
mkdir $SNPE_ROOT/models/alexnet/ConvUdoCpu
snpe-udo-package-generator -p $SNPE_ROOT/examples/NativeCpp/UdoExample/Conv2D/config/Conv2D.json -o $SNPE_ROOT/models/alexnet/ConvUdoCpu
</pre><p>or for DSP</p>
<pre class="fragment">export SNPE_UDO_ROOT=$SNPE_ROOT/share/SnpeUdo
mkdir $SNPE_ROOT/models/alexnet/ConvUdoDsp
snpe-udo-package-generator -p $SNPE_ROOT/examples/NativeCpp/UdoExample/Conv2D/config/Conv2DQuant.json -o $SNPE_ROOT/models/alexnet/ConvUdoDsp
</pre><p>This command creates the Convolution based package at $SNPE_ROOT/models/alexnet/ConvUdoCpu/Conv2DPackage or $SNPE_ROOT/models/alexnet/ConvUdoDsp/Conv2DPackage</p>
<p>For more information on the snpe-udo-package-generator tool visit <a class="el" href="creating_udo_package.html">here</a>.</p>
<h1><a class="anchor" id="alexnet_udo_conversion"></a>
Step 2: Framework model Conversion to a DLC</h1>
<p>Converting the Caffe Alexnet model to DLC requires the <b>snpe-caffe-to-dlc</b> tool. The snpe-caffe-to-dlc tool consumes the same Conv2D.json used in package generation via the --udo command line option. In this step, &lt;ALEXNET_PATH&gt; refers to the path to the deploy.prototxt and bvlc_alexnet.caffemodel file. For example, after running the setup_alexnet.py script &lt;ALEXNET_PATH&gt; is $SNPE_ROOT/models/alexnet/caffe.</p>
<p>Convert Alexnet with the following: </p><pre class="fragment">snpe-caffe-to-dlc --input_network &lt;ALEXNET_PATH&gt;/deploy_batch_1.prototxt --caffe_bin &lt;ALEXNET_PATH&gt;/bvlc_alexnet.caffemodel --output_path $SNPE_ROOT/models/alexnet/dlc/alexnet_udo.dlc --udo $SNPE_ROOT/examples/NativeCpp/UdoExample/Conv2D/config/Conv2D.json
</pre><p>This will generate a DLC named alexnet_udo.dlc containing the Convolution as UDO at $SNPE_ROOT/models/alexnet/dlc.</p>
<h1><a class="anchor" id="alexnet_udo_impl"></a>
Step 3: Package Implementations</h1>
<p>The generated package creates the skeleton of the operation implementation, which must be filled by the user to create a functional UDO. Additionally, the skeleton for a user implemented validation function can be populated to validate information about the UDO passed from the SNPE runtime. The rest of the code scaffolding for compatibility with SNPE is provided by the snpe-udo-package-generator.</p>
<p>The UDO implementations and validation function for this tutorial are provided under $SNPE_ROOT/examples/NativeCpp/UdoExample/Conv2D/src.</p>
<p><b>Note:</b> Implementing validation is user-specific and not a strict requirement for using a UDO in SNPE. Only CPU Validation is provided as example.</p>
<p><b>CPU Implementations (Android and x86)</b></p>
<p>The files in the package that need to be implemented for CPU are</p><ul>
<li>ConvUdoCpu/Conv2DPackage/jni/src/CPU/ConvolutionImplLibCpu.cpp</li>
<li>ConvUdoCpu/Conv2DPackage/jni/src/reg/Conv2DPackageCpuImplValidationFunctions.cpp</li>
</ul>
<p>The provided example implementations for these files are at the locations</p><ul>
<li>$SNPE_ROOT/examples/NativeCpp/UdoExample/Conv2D/src/CPU/ConvolutionImplLibCpu.cpp</li>
<li>$SNPE_ROOT/examples/NativeCpp/UdoExample/Conv2D/src/reg/Conv2DPackageCpuImplValidationFunctions.cpp</li>
</ul>
<p>Copy the provided implementations to the package: </p><pre class="fragment">cp -f $SNPE_ROOT/examples/NativeCpp/UdoExample/Conv2D/src/CPU/ConvolutionImplLibCpu.cpp $SNPE_ROOT/models/alexnet/ConvUdoCpu/Conv2DPackage/jni/src/CPU/
cp -f $SNPE_ROOT/examples/NativeCpp/UdoExample/Conv2D/src/reg/Conv2DPackageCpuImplValidationFunctions.cpp $SNPE_ROOT/models/alexnet/ConvUdoCpu/Conv2DPackage/jni/src/reg/
</pre><p><b>Dsp Implementations (Android)</b></p>
<p>The files in the package that need to be implemented for DSP are</p><ul>
<li>ConvUdoDsp/Conv2DPackage/jni/src/DSP/ConvolutionImplLibDsp.c</li>
<li>ConvUdoDsp/Conv2DPackage/include/ConvolutionImplLibDsp.h</li>
</ul>
<p>The provided example implementations for these files are at the locations</p><ul>
<li>$SNPE_ROOT/examples/NativeCpp/UdoExample/Conv2D/src/DSP/Conv2DInt8Impl/ConvolutionImplLibDsp.c</li>
<li>$SNPE_ROOT/examples/NativeCpp/UdoExample/Conv2D/src/DSP/Conv2DInt8Impl/ConvolutionImplLibDsp.h</li>
</ul>
<p>Copy the provided implementations to the package: </p><pre class="fragment">cp -f $SNPE_ROOT/examples/NativeCpp/UdoExample/Conv2D/src/DSP/Conv2DInt8Impl/ConvolutionImplLibDsp.c $SNPE_ROOT/models/alexnet/ConvUdoDsp/Conv2DPackage/jni/src/DSP/
cp -f $SNPE_ROOT/examples/NativeCpp/UdoExample/Conv2D/src/DSP/Conv2DInt8Impl/ConvolutionImplLibDsp.h $SNPE_ROOT/models/alexnet/ConvUdoDsp/Conv2DPackage/include/
</pre><p>Optionally, the user can provide their own implementations in the package.</p>
<h1><a class="anchor" id="alexnet_udo_compilation"></a>
Step 4: Package Compilation</h1>
<p><b>x86 Host Compilation</b></p>
<p>Compiling on x86 host uses the make build system. Compile the CPU implementations with the following: </p><pre class="fragment">cd $SNPE_ROOT/models/alexnet/ConvUdoCpu/Conv2DPackage
make cpu_x86
</pre><p>The expected artifacts after compiling for CPU on x86 host are</p><ul>
<li>ConvUdoCpu/Conv2DPackage/libs/x86-64_linux_clang/libUdoConv2DPackageImplCpu.so</li>
<li>ConvUdoCpu/Conv2DPackage/libs/x86-64_linux_clang/libUdoConv2DPackageReg.so</li>
</ul>
<p><b>Android CPU Runtime Compilation</b></p>
<p>Compilation for the CPU runtime on Android uses Android NDK. The ANDROID_NDK_ROOT environment variable must be set to the directory containing ndk-build in order to compile the package. </p><pre class="fragment">export ANDROID_NDK_ROOT=&lt;path_to_android_ndk&gt;
</pre><p>It is suggested to add ANDROID_NDK_ROOT to the PATH environment variable to access ndk-build. </p><pre class="fragment">export PATH=$ANDROID_NDK_ROOT:$PATH
</pre><p>Target architecture must also be specified when compiling the package. </p><pre class="fragment">export UDO_APP_ABI=&lt;target_architecture&gt;
</pre><p>This tutorial uses arm64-v8a architectures - it is recommended but not required to use arm64-v8a as the target architecture for the remainder of the tutorial. If no target architecture is supplied both arm64-v8a and armeabi-v7a are targeted.</p>
<p>Once the ANDROID_NDK_ROOT is part of PATH, compile the package for Android CPU target: </p><pre class="fragment">cd $SNPE_ROOT/models/alexnet/ConvUdoCpu/Conv2DPackage
make cpu_android PLATFORM=$UDO_APP_ABI
</pre><p>The expected artifacts after compiling for Android CPU are</p><ul>
<li>ConvUdoCpu/Conv2DPackage/libs/&lt;target_architecture&gt;/libUdoConv2DPackageImplCpu.so</li>
<li>ConvUdoCpu/Conv2DPackage/libs/&lt;target_architecture&gt;/libUdoConv2DPackageReg.so</li>
<li>ConvUdoCpu/Conv2DPackage/libs/&lt;target_architecture&gt;/libc++_shared.so</li>
</ul>
<p><b>Hexagon DSP Runtime Compilation</b></p>
<p>Compilation for the DSP runtime makes use of the make system. In order to build the DSP implementation libraries, Hexagon-SDK needs to be installed and set up. For details, follow the setup instructions on <code>$HEXAGON_SDK_ROOT/docs/readme.html</code> page, where <code>HEXAGON_SDK_ROOT</code> is the location of your Hexagon-SDK installation.</p>
<p><b>Note:</b> This SNPE release supports building UDO DSP implementation libraries using Hexagon-SDK 3.5.1/3.5.2.</p>
<p>Make sure that HEXAGON_SDK_ROOT, HEXAGON_TOOLS_ROOT and SDK_SETUP_ENV=Done is set. </p><pre class="fragment">export HEXAGON_SDK_ROOT=&lt;path to hexagon sdk installation&gt;
export HEXAGON_TOOLS_ROOT=$HEXAGON_SDK_ROOT/tools/HEXAGON_Tools/8.3.07
export SDK_SETUP_ENV=Done
</pre><p>With the environment set up, compile for DSP with the following: </p><pre class="fragment">cd $SNPE_ROOT/models/alexnet/ConvUdoDsp/Conv2DPackage
make dsp PLATFORM=$UDO_ABI
</pre><p>The expected artifacts after compiling for Hexagon DSP are</p><ul>
<li>ConvUdoDsp/Conv2DPackage/libs/dsp/libUdoConv2DPackageImplDsp.so</li>
<li>ConvUdoDsp/Conv2DPackage/libs/$UDO_APP_ABI/libUdoConv2DPackageReg.so</li>
</ul>
<p><b>Note:</b> For DSP, PLATFORM will only determine the ABI of the registration library.</p>
<h1><a class="anchor" id="alexnet_udo_execution"></a>
Model Execution</h1>
<p><b>Execution using snpe-net-run</b></p>
<p>Executing Inception-V3 for UDO is largely the same as use of <a class="el" href="tutorial_inceptionv3.html#overview_native_app">snpe-net-run</a> without UDO.</p>
<p>The SNPE SDK provides Linux and Android binaries of <b>snpe-net-run</b> under</p><ul>
<li>$SNPE_ROOT/bin/x86_64-linux-clang</li>
<li>$SNPE_ROOT/bin/arm-android-clang6.0</li>
<li>$SNPE_ROOT/bin/aarch64-android-clang6.0</li>
<li>$SNPE_ROOT/bin/aarch64-linux-gcc4.9</li>
<li>$SNPE_ROOT/bin/arm-linux-gcc4.9sf</li>
<li>$SNPE_ROOT/bin/aarch64-oe-linux-gcc6.4</li>
<li>$SNPE_ROOT/bin/arm-oe-linux-gcc6.4hf</li>
</ul>
<p>For UDO, snpe-net-run consumes the registration library through the --udo_package_path option. LD_LIBRARY_PATH must also be updated to include the runtime-specific artifacts generated from package compilation.</p>
<p><b>x86 Host Execution</b></p>
<p>To execute the network on x86 host, run: </p><pre class="fragment">cd $SNPE_ROOT/models/alexnet
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$SNPE_ROOT/models/alexnet/ConvUdoCpu/Conv2DPackage/libs/x86-64_linux_clang/
snpe-net-run --container dlc/alexnet_udo.dlc --input_list data/cropped/raw_list.txt --udo_package_path ConvUdoCpu/Conv2DPackage/libs/x86-64_linux_clang/libUdoConv2DPackageReg.so
</pre><p><b>Android Target Execution</b></p>
<p>The tutorial for execution on Android targets will use the arm64-v8a architecture. This portion of the tutorial is generic to all runtimes (CPU, DSP).</p>
<pre class="fragment"># architecture: arm64-v8a - compiler: clang - STL: libc++
export SNPE_TARGET_ARCH=aarch64-android-clang6.0
export SNPE_TARGET_STL=libc++_shared.so
</pre><p>Then, push SNPE binaries and libraries to the target device: </p><pre class="fragment">adb shell "mkdir -p /data/local/tmp/snpeexample/$SNPE_TARGET_ARCH/bin"
adb shell "mkdir -p /data/local/tmp/snpeexample/$SNPE_TARGET_ARCH/lib"

adb push $SNPE_ROOT/lib/$SNPE_TARGET_ARCH/$SNPE_TARGET_STL \
      /data/local/tmp/snpeexample/$SNPE_TARGET_ARCH/lib
adb push $SNPE_ROOT/lib/$SNPE_TARGET_ARCH/*.so \
      /data/local/tmp/snpeexample/$SNPE_TARGET_ARCH/lib
adb push $SNPE_ROOT/bin/$SNPE_TARGET_ARCH/snpe-net-run \
      /data/local/tmp/snpeexample/$SNPE_TARGET_ARCH/bin
</pre><p>Next, update environment variables on the target device to include the SNPE libraries and binaries: </p><pre class="fragment">adb shell
export SNPE_TARGET_ARCH=aarch64-android-clang6.0
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/data/local/tmp/snpeexample/$SNPE_TARGET_ARCH/lib
export PATH=$PATH:/data/local/tmp/snpeexample/$SNPE_TARGET_ARCH/bin
</pre><p>Lastly, push the Alexnet UDO model and input data to the device: </p><pre class="fragment">cd $SNPE_ROOT/models/alexnet
mkdir data/rawfiles &amp;&amp; cp data/cropped/*.raw data/rawfiles/
adb shell "mkdir -p /data/local/tmp/alexnet_udo"
adb push data/rawfiles /data/local/tmp/alexnet_udo/cropped
adb push data/target_raw_list.txt /data/local/tmp/alexnet_udo
adb push dlc/alexnet_udo.dlc /data/local/tmp/alexnet_udo
rm -rf data/rawfiles
</pre><p><b>Android CPU Execution</b></p>
<p>Once the model and data have been placed on the device, place the UDO libraries on the device: </p><pre class="fragment">cd $SNPE_ROOT/models/alexnet/ConvUdoCpu
adb shell "mkdir -p /data/local/tmp/alexnet_udo/cpu"
adb push Conv2DPackage/libs/arm64-v8a/libUdoConv2DUdoPackageImplCpu.so /data/local/tmp/alexnet_udo/cpu
adb push Conv2DPackage/libs/arm64-v8a/libUdoConv2DUdoPackageReg.so /data/local/tmp/alexnet_udo/cpu
adb push Conv2DPackage/libs/arm64-v8a/libc++_shared.so /data/local/tmp/alexnet_udo/cpu
</pre><p>Now set required environment variables and run snpe-net-run on device: </p><pre class="fragment">adb shell
cd /data/local/tmp/alexnet_udo/
export LD_LIBRARY_PATH=/data/local/tmp/alexnet_udo/cpu/:$LD_LIBRARY_PATH
snpe-net-run --container alexnet_udo.dlc --input_list target_raw_list.txt --udo_package_path cpu/libUdoConv2DPackageReg.so
</pre><p><b>Hexagon DSP Execution</b></p>
<p>The procedure for execution on device for DSP is largely the same as CPU and GPU. However, the DSP runtime requires quantized network parameters. While DSP allows unquantized DLCs, it is generally recommended to quantize DLCs for improved performance. The tutorial will use a quantized DLC as an illustrative example. Quantizing the DLC requires the <b>snpe-dlc-quantize</b> tool.</p>
<p>To quantize the DLC for use on DSP: </p><pre class="fragment">cd $SNPE_ROOT/models/alexnet/
snpe-dlc-quantize --input_dlc dlc/alexnet_udo.dlc --input_list data/cropped/raw_list.txt --udo_package_path ConvUdoCpu/Conv2DPackage/libs/x86-64_linux_clang/libUdoConv2DPackageReg.so --output_dlc dlc/alexnet_udo_quantized.dlc
</pre><p>For more information on snpe-dlc-quantize visit <a class="el" href="quantized_models.html#overview_quantize">quantization</a>. For information on UDO-specific quantization visit <a class="el" href="preparing_model_with_udo.html#quantize_network_with_udo">Quantizing a DLC with UDO</a>. For information on DSP runtime visit <a class="el" href="dsp_runtime.html">DSP Runtime</a>.</p>
<p>Now push the quantized model to device: </p><pre class="fragment">adb push dlc/alexnet_udo_quantized.dlc /data/local/tmp/alexnet_udo
</pre><p>Before executing on the DSP, push the SNPE libraries for DSP to device: </p><pre class="fragment">adb shell "mkdir -p /data/local/tmp/snpeexample/dsp/lib"
adb push $SNPE_ROOT/lib/dsp/*.so \
      /data/local/tmp/snpeexample/dsp/lib
</pre><p>Now push DSP-specific UDO libraries to device: </p><pre class="fragment">cd $SNPE_ROOT/models/alexnet/ConvUdoDsp
adb shell "mkdir -p /data/local/tmp/alexnet_udo/dsp"
adb push Conv2DPackage/libs/dsp/*.so /data/local/tmp/alexnet_udo/dsp
adb push Conv2DPackage/libs/arm64-v8a/libUdoConv2DPackageReg.so /data/local/tmp/alexnet_udo/dsp # Pushes reg lib
</pre><p>Then set required environment variables and run snpe-net-run on device: </p><pre class="fragment">adb shell
cd /data/local/tmp/alexnet_udo/
export LD_LIBRARY_PATH=/data/local/tmp/alexnet_udo/dsp/:$LD_LIBRARY_PATH
export ADSP_LIBRARY_PATH="/data/local/tmp/alexnet_udo/dsp/;/data/local/tmp/snpeexample/dsp/lib;/system/lib/rfsa/adsp;/system/vendor/lib/rfsa/adsp;/dsp"
snpe-net-run --container alexnet_udo_quantized.dlc --input_list target_raw_list.txt --udo_package_path dsp/libUdoConv2DPackageReg.so --use_dsp
</pre><p>To verify classification results run the following on your host cpu machine .</p>
<pre class="fragment">cd $SNPE_ROOT/models/alexnet/
adb pull /data/local/tmp/alexnet_udo/output .
python3 $SNPE_ROOT/models/alexnet/scripts/show_alexnet_classifications.py -i data/cropped/raw_list.txt \
                                                                         -o output/ \
                                                                         -l data/ilsvrc_2012_labels.txt
</pre><p>The output should look like the following, showing classification results for all the images.</p>
<pre class="fragment">Classification results
&lt;input_files_dir&gt;/trash_bin.raw     0.949348 412 ashcan, trash can, garbage can,
                                                 wastebin, ash bin, ash-bin, ashbin,
                                                 dustbin, trash barrel, trash bin

&lt;input_files_dir&gt;/plastic_cup.raw   0.749104 647 measuring cup
&lt;input_files_dir&gt;/chairs.raw        0.365685 831 studio couch, day bed
&lt;input_files_dir&gt;/notice_sign.raw   0.722708 458 brass, memorial tablet, plaque
</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  Copyright (c) 2016-2018 Qualcomm Technologies, Inc.
  All Rights Reserved.
  Confidential and Proprietary - Qualcomm Technologies, Inc.
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 -->
<!-- start footer part -->
<div id="nav-path" class="navpath" font-size:small;><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <p align="right">
        80-NL315-14 A <br>
        MAY CONTAIN U.S. AND INTERNATIONAL EXPORT CONTROLLED INFORMATION
        <!--If the Controlled Distribution statement is to be included, uncomment below:-->
        <!--<b>Controlled Distribution - DO NOT COPY</b>-->
        <img class="footer" width:5%; alt="QTI Logo" src="images/QTI_Logo.png" />
      </p>
    </li>
  </ul>
</div>
</body>
</html>
